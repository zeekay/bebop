(function(global){function rqzt(file,callback){if({}.hasOwnProperty.call(rqzt.cache,file))return rqzt.cache[file];if('function'==typeof callback)return void rqzt.load(file,callback);var resolved=rqzt.resolve(file);if(!resolved)throw new Error('Failed to resolve module '+file);var module$={id:file,rqzt:rqzt,filename:file,exports:{},loaded:!1,parent:null,children:[]},dirname=file.slice(0,file.lastIndexOf('/')+1);return rqzt.cache[file]=module$.exports,resolved.call(module$.exports,module$,module$.exports,dirname,file),module$.loaded=!0,rqzt.cache[file]=module$.exports};rqzt.modules={},rqzt.cache={},rqzt.resolve=function(file){return{}.hasOwnProperty.call(rqzt.modules,file)?rqzt.modules[file]:undefined},rqzt.define=function(file,fn){rqzt.modules[file]=fn},rqzt.define('./client/bebop',function(module,exports,__dirname,__filename,process){var Bebop,EventEmitter,WebSocket,dir,dump,findNode,log,ref,reloadNode,root,stacktrace,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;EventEmitter=rqzt('./client/event-emitter'),WebSocket=rqzt('./client/websocket'),dir=rqzt('./client/dir'),dump=rqzt('./client/dump'),log=rqzt('./client/log'),stacktrace=rqzt('./client/stacktrace'),(ref=rqzt('./client/node'),reloadNode=ref.reloadNode,findNode=ref.findNode),root=rqzt('./client/utils').root,Bebop=function(superClass){function Bebop(opts){var hostname,port,protocol,ref1,ref2,ref3,ref4,ref5,ref6;null==opts&&(opts={}),Bebop.__super__.constructor.apply(this,arguments),protocol=null!=(ref1=opts.protocol)?ref1:'http:'===location.protocol?'ws://':'wss://',hostname=null!=(ref2=opts.hostname)?ref2:location.hostname,port=null!=(ref3=opts.port)?ref3:location.port,this.address=null!=(ref4=opts.address)?ref4:protocol+hostname+':'+port+'/_bebop',this.timeout=null!=(ref5=opts.timeout)?ref5:1e3,this.debug=null!=(ref6=opts.debug)&&ref6,this.tries=0,this.limit=-1,this._failed=!1,this._retries=[],this._once={error:!1,closed:!1},this.init(opts)}return extend(Bebop,superClass),Bebop.prototype.defaultHandlers={connected:function(){return log.info('connected'),this._once={error:!1,closed:!1},this.sendConnected()},reconnecting:function(){return log.info('reconnecting')},closed:function(){return this._once.closed||log.info('closed'),this._once.closed=!0},error:function(){return this._once.error||log.error('error'),this._once.error=!0},message:function(message){switch(log.debug('message'),message.type){case'complete':return this.sendComplete(message.name);case'eval':return this.sendEval(message.code);case'modified':return this.modified(message.filename);case'reload':return this.reload();default:return log.warn("Unknown message type '"+message.type+"'",message)}}},Bebop.prototype.init=function(opts){var handlers,k,ref1,v;null==opts&&(opts={}),handlers={connected:opts.onconnected,closed:opts.onclosed,error:opts.onerror,message:opts.onmessage,reconnecting:opts.reconnecting},ref1=this.defaultHandlers;for(k in ref1)v=ref1[k],null==handlers[k]&&(handlers[k]=v);return this.on('connect',function(_this){return function(){if(null!=_this.limit&&_this.limit>=0)return _this.tries>_this.limit?(log.error('Bebop.connect','connection-failed: giving up!'),_this._failed=!0):_this.tries=_this.tries+1}}(this)),this.on('connected',function(_this){return function(){return _this.tries=0,handlers.connected.apply(_this,arguments)}}(this)),this.on('closed',function(_this){return function(){return handlers.closed.apply(_this,arguments)}}(this)),this.on('error',function(_this){return function(){return handlers.error.apply(_this,arguments)}}(this)),this.on('message',function(_this){return function(){return handlers.message.apply(_this,arguments)}}(this)),this.on('reconnecting',function(_this){return function(){return handlers.reconnecting.apply(_this,arguments)}}(this))},Bebop.prototype.connect=function(){var err;if(!this._failed){this.emit('connecting');try{this.ws=new WebSocket(this.address)}catch(error1){return err=error1,log.warn('Failed to create WebSocket',err),this.reconnect()}return this.ws.onopen=function(_this){return function(){var args;return _this.stopRetrying(),args=Array.prototype.slice.call(arguments),args.unshift('connected'),_this.emit.apply(_this,args)}}(this),this.ws.onclose=function(_this){return function(){var args;return args=Array.prototype.slice.call(arguments),args.unshift('closed'),_this.emit.apply(_this,args)}}(this),this.ws.onerror=function(_this){return function(){var args;return args=Array.prototype.slice.call(arguments),args.unshift('error'),_this.emit.apply(_this,args)}}(this),this.ws.onmessage=function(_this){return function(e){return _this.emit('message',JSON.parse(e.data))}}(this),root.isBrowser?root.addEventListener('beforeunload',function(_this){return function(){return _this.ws.close()}}(this)):undefined}},Bebop.prototype.reconnect=function(){if(!this._failed)return this.emit('reconnecting'),this._retries.push(root.setTimeout(function(_this){return function(){return _this.connect()}}(this),this.timeout))},Bebop.prototype.stopRetrying=function(){var i,len,ref1,t;for(this.tries=0,ref1=this._retries,i=0,len=ref1.length;i<len;i++)t=ref1[i],clearTimeout(t);return this._retries=[]},Bebop.prototype.close=function(){return this.ws.close()},Bebop.prototype.send=function(msg){return this.emit('send',msg),this.ws.send(JSON.stringify(msg))},Bebop.prototype.complete=function(code){var e;this.emit('complete',code);try{return dir(eval_.call(root,code))}catch(error1){return e=error1,[]}},Bebop.prototype.eval=function(code){var e,error,res;this.emit('eval',code);try{return res=eval_.call(root,msg)}catch(error1){return e=error1,error={error:e.message,stack:stacktrace(e)}}},Bebop.prototype.modified=function(filename){var node;if(this.emit('modified',filename),isBrowser)return node=findNode(filename),node&&'script'!==node._resource.tag.name?reloadNode(node):this.reload(!0)},Bebop.prototype.reload=function(){return this.emit('reload'),this.close(),location.reload()},Bebop.prototype.sendConnected=function(){return this.send({type:'connected',identifier:this.ws.identifier})},Bebop.prototype.sendComplete=function(code){return this.send({type:'complete',result:this.complete(code)})},Bebop.prototype.sendEval=function(code){return this.send({type:'eval',result:this.eval(code)})},Bebop}(EventEmitter),module.exports=Bebop}),rqzt.define('./client/event-emitter',function(module,exports,__dirname,__filename,process){var EventEmitter,slice=[].slice;module.exports=EventEmitter=function(){function EventEmitter(opts){null==opts&&(opts={}),this._listeners={},this._allListeners=[]}return EventEmitter.prototype.on=function(event,callback){var base;return event?(null==(base=this._listeners)[event]&&(base[event]=[]),this._listeners[event].push(callback),this._listeners[event].length-1):(this._allListeners.push(callback),this._allListeners.length-1)},EventEmitter.prototype.off=function(event,index){return event?void(null!=index?this._listeners[event][index]=null:this._listeners[event]={}):this._listeners={}},EventEmitter.prototype.emit=function(){var args,event,i,j,len,len1,listener,listeners,ref,results;for((event=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[]),listeners=this._listeners[event]||[],i=0,len=listeners.length;i<len;i++)listener=listeners[i],null!=listener&&listener.apply(this,args);for(args.unshift(event),ref=this._allListeners,results=[],j=0,len1=ref.length;j<len1;j++)listener=ref[j],results.push(listener.apply(this,args));return results},EventEmitter}()}),rqzt.define('./client/websocket',function(module,exports,__dirname,__filename,process){var WebSocket,fallback,load,ref,ref1,root,urls;root=rqzt('./client/utils').root,load=rqzt('./client/node').load,root.WEB_SOCKET_SWF_LOCATION='https://cdnjs.cloudflare.com/ajax/libs/web-socket-js/1.0.0/WebSocketMain.swf',urls=['https://cdnjs.cloudflare.com/ajax/libs/web-socket-js/1.0.0/web_socket.js','https://cdnjs.cloudflare.com/ajax/libs/web-socket-js/1.0.0/web_socket.min.js'],fallback=function(){var i,len,url;for(i=0,len=urls.length;i<len;i++)url=urls[i],load(url);return root.WebSocket},WebSocket=null!=(ref=null!=(ref1=root.WebSocket)?ref1:root.MozWebSocket)?ref:fallback(),root.isBrowser?WebSocket.identifier=location.href+' - '+navigator.userAgent:WebSocket.identifier=process.argv[1]+' - node',module.exports=WebSocket}),rqzt.define('./client/utils',function(module,exports,__dirname,__filename,process){var querystring,random;querystring=rqzt('querystring-es3'),exports.root=function(){var root;return'undefined'==typeof window?root=global:(root=window,root.isBrowser=!0),null==root.location&&(root.location={protocol:'http:',hostname:'localhost',port:'3333'}),root}(),random=function(){return(1048576*(1+Math.random())|0).toString(16)},exports.urlRandomize=function(url){var path,query,ref;return ref=url.split('?'),path=ref[0],query=ref[1],null==query?path+'?bop='+random():(query=querystring.parse(query),query.bop=random(),path+'?'+querystring.stringify(query))}}),rqzt.define('querystring-es3',function(module,exports,__dirname,__filename,process){'use strict';exports.decode=exports.parse=rqzt('querystring-es3/decode'),exports.encode=exports.stringify=rqzt('querystring-es3/encode')}),rqzt.define('querystring-es3/decode',function(module,exports,__dirname,__filename,process){'use strict';function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||'&',eq=eq||'=';var obj={};if('string'!=typeof qs||0===qs.length)return obj;var regexp='/\\+/g';qs=qs.split(sep);var maxKeys=1e3;options&&'number'==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,'%20'),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=''),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return'[object Array]'===Object.prototype.toString.call(xs)}}),rqzt.define('querystring-es3/encode',function(module,exports,__dirname,__filename,process){'use strict';function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case'string':return v;case'boolean':return v?'true':'false';case'number':return isFinite(v)?v:'';default:return''}};module.exports=function(obj,sep,eq,name){return sep=sep||'&',eq=eq||'=',null===obj&&(obj=undefined),'object'==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):''};var isArray=Array.isArray||function(xs){return'[object Array]'===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}}),rqzt.define('./client/node',function(module,exports,__dirname,__filename,process){var findNode,load,log,parseFilename,reloadNode,tags,utils;tags=rqzt('./client/tags'),log=rqzt('./client/log'),utils=rqzt('./client/utils'),parseFilename=function(filename){var ext,path,resource;return path=filename.split('/'),filename=path.pop(),ext=filename.split('.')[1],resource={ext:ext,filename:filename,path:path,tag:tags[ext]}},findNode=function(filename){var i,len,node,re,ref,resource;if(''!==filename&&null!=(resource=parseFilename(filename)).tag){for(re=new RegExp(filename+'$'),ref=document.getElementsByTagName(resource.tag.name),i=0,len=ref.length;i<len;i++)if(node=ref[i],re.test(node[resource.tag.link].split('?')[0]))return resource.url=node[resource.tag.link],node._resource=resource,node;return null}},reloadNode=function(node){var link;return'js'===node._resource.ext?(node.parentNode.removeChild(node),load(node._resource)):(link=node._resource.tag.link,navigator.userAgent.toLowerCase().indexOf('chrome')>-1&&(node[link]='#break-the-url'),node[link]=utils.urlRandomize(node._resource.url),log.info('resource-reloaded',node[link]))},load=function(resource){var node;return node=document.createElement(resource.tag.name),node[resource.tag.link]=resource.url,node.type=resource.tag.type,document.getElementsByTagName('head')[0].appendChild(node),log.info('resource-loaded',node[resource.tag.link])},module.exports={findNode:findNode,reloadNode:reloadNode,load:load}}),rqzt.define('./client/tags',function(module,exports,__dirname,__filename,process){module.exports={js:{link:'src',name:'script',type:'text/javascript'},css:{link:'href',name:'link',type:'text/css'}}}),rqzt.define('./client/log',function(module,exports,__dirname,__filename,process){var Logger,levels,root;root=rqzt('./client/utils').root,levels=['debug','info','warn','error'],Logger=function(){function Logger(options){var fn,i,len,level;for(fn=function(_this){return function(level){return _this[level]=function(){var args;return args=Array.prototype.slice.call(arguments),args.unshift('bebop:'+level),_this.log.apply(_this,args)}}}(this),i=0,len=levels.length;i<len;i++)level=levels[i],fn(level)}return Logger.prototype.log=function(){return'undefined'!=typeof console&&null!==console?console.log.apply(console,arguments):undefined},Logger.prototype.setLevels=function(levels){return this.levels=levels},Logger.prototype.debug=function(enable){return enable?this.setLevels(levels):this.setLevels(['info','warning','error'])},Logger}(),module.exports=new Logger}),rqzt.define('./client/dir',function(module,exports,__dirname,__filename,process){module.exports=function(object){var i,properties,property,seen,valid;if(valid=function(name){var i,invalid;invalid=['arguments','caller','name','length','prototype'];for(i in invalid)if(invalid[i]===name)return!1;return!0},properties=[],seen={},'undefined'!==Object.getOwnPropertyNames){properties=Object.getOwnPropertyNames(object);for(property in object)properties.push(property);for(properties=properties.filter(function(name){return valid(name)}),i=0;i<properties.length;)seen[properties[i]]='',i++;return Object.keys(seen)}for(property in object)properties.push(property);return properties}}),rqzt.define('./client/dump',function(module,exports,__dirname,__filename,process){var dir;dir=rqzt('./client/dir'),module.exports=function(object,cb){var derez,objects,paths;return objects=[],paths=[],(derez=function(_this){return function(value,path){var e,funcname,i,name,nu,properties;switch(typeof value){case'object':if(!value)return null;for(i=0;i<objects.length;){if(objects[i]===value)return{$ref:paths[i]};i+=1}if(objects.push(value),paths.push(path),'[object Array]'===Object.prototype.toString.apply(value))for(nu=[],i=0;i<value.length;)nu[i]=derez(value[i],path+'['+i+']'),i+=1;else{nu={},properties=dir(value);for(i in properties)if(name=properties[i],'function'==typeof value[name])if(funcname=(value[name].toString().split(')')[0]+')').replace(' '+name,''),dir(value[name]).length<1)nu[name]=funcname;else try{nu[name]=derez(value[name],path+'['+JSON.stringify(name)+']')}catch(undefined){}else try{nu[name]=derez(value[name],path+'['+JSON.stringify(name)+']')}catch(undefined){}}return nu;case'number':case'string':case'boolean':return value;case'function':try{properties=dir(value),objects.push(value),paths.push(path),nu={};for(i in properties)name=properties[i],'function'==typeof value[name]?(funcname=(value[name].toString().split(')')[0]+')').replace(' '+name,''),dir(value[name]).length<1?nu[name]=funcname:nu[name]=derez(value[name],path+'['+JSON.stringify(name)+']')):nu[name]=derez(value[name],path+'['+JSON.stringify(name)+']');return nu}catch(error){return e=error,nu}}}}(this))(object,'$')}}),rqzt.define('./client/stacktrace',function(module,exports,__dirname,__filename,process){var chrome,firefox,other,stringifyArguments;stringifyArguments=function(args){var arg,i,result,slice;for(result=[],slice=Array.prototype.slice,i=0;i<args.length;)arg=args[i],undefined===arg?result[i]='undefined':null===arg?result[i]='null':arg.constructor&&(arg.constructor===Array?arg.length<3?result[i]='['+stringifyArguments(arg)+']':result[i]='['+stringifyArguments(slice.call(arg,0,1))+'...'+stringifyArguments(slice.call(arg,-1))+']':arg.constructor===Object?result[i]='#object':arg.constructor===Function?result[i]='#function':arg.constructor===String?result[i]='"'+arg+'"':arg.constructor===Number&&(result[i]=arg)),++i;return result.join(',')},chrome=function(e){var stack;return stack=(e.stack+'\n').replace('/^\\S[^\\(]+?[\\n$]/g','').replace('/^\\s+(at eval )?at\\s+/g','').replace('/^([^\\(]+?)([\\n$])/g','{anonymous}()@$1$2').replace('/^Object.<anonymous>\\s*\\(([^\\)]+)\\)/g','{anonymous}()@$1').split('\n'),stack.pop(),stack},firefox=function(e){return e.stack.replace('/(?:\\n@:0)?\\s+$/m','').replace('/^\\(/g','{anonymous}(').split('\n')},other=function(curr){var ANON,args,fn,fnRE,maxStackSize,stack;for(ANON='{anonymous}',fnRE='/function\\s*([\\w\\-$]+)?\\s*\\(/i',stack=[],fn=undefined,args=undefined,maxStackSize=10;curr&&curr.arguments&&stack.length<maxStackSize;)fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON,args=Array.prototype.slice.call(curr.arguments||[]),stack[stack.length]=fn+'('+stringifyArguments(args)+')',curr=curr.caller;return stack},module.exports=function(e){return e.arguments&&e.stack?method.chrome(e):e.stack?method.firefox(e):method.other(e)}}),rqzt.define('./client',function(module,exports,__dirname,__filename,process){var Bebop,root;Bebop=rqzt('./client/bebop'),root=rqzt('./client/utils').root,root.Bebop=module.exports=Bebop}),rqzt('./client')}.call(this,this))